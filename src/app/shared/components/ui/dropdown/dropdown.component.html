<div class="relative w-full">
  <button
    [class]="customClass()"
    type="button"
    class="flex h-[44px] w-full items-center justify-between gap-4 rounded-xl border border-platinum-20 bg-white px-3.5 py-2.5 text-platinum-100 transition-colors focus:outline-none"
    [ngClass]="{
      'border-valencia-50 hover:border-valencia-50 focus:border-valencia-50 focus:ring-1 focus:ring-valencia-50':
        error(),
      'focus:border-platinum-30': !error(),
    }"
    (click)="opened.set(!opened())"
  >
    <span
      class="truncate"
      [ngClass]="{
        'text-platinum-50': !selectedValue(),
        'text-platinum-100': selectedValue(),
      }"
    >
      {{ selectedValue() ? itemLabel() : placeholder() }}
    </span>

    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M6 9L11.2929 14.6854C11.6834 15.1049 12.3166 15.1049 12.7071 14.6854L18 9"
        stroke="#6D6D6D"
        stroke-width="1.5"
        stroke-linecap="round"
      />
    </svg>
  </button>

  @if (opened()) {
    <div
      (outsideClick)="opened.set(false)"
      class="absolute z-10 mt-1 w-full min-w-[100px] max-w-full rounded-xl border border-platinum-20 bg-white text-sm shadow-md"
    >
      <div class="max-h-60 space-y-1 overflow-y-auto p-2">
        @for (item of items(); track item.value) {
          <button
            type="button"
            class="w-full rounded-lg px-3 py-2 text-left text-platinum-100 transition-colors"
            [ngClass]="
              selectedValue() === item.value
                ? 'bg-green-10 font-medium text-green-70'
                : 'hover:bg-platinum-10'
            "
            (click)="selectItem(item.value)"
          >
            <div class="flex items-center justify-between">
              <span>{{ item.label }}</span>
              @if (selectedValue() === item.value) {
                <svg
                  class="h-5 w-5 flex-shrink-0 text-green-60"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M5 13l4 4L19 7"
                  />
                </svg>
              }
            </div>
          </button>
        }
      </div>
    </div>
  }
</div>
